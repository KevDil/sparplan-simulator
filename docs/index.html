<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sparplan & Entnahme Simulator (Web)</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="brand__dot"></div>
      <div>
        <p class="eyebrow">ETF & Tagesgeld</p>
        <h1>Sparplan- & Entnahme-Simulator</h1>
      </div>
    </div>
    <button class="btn-info" id="btn-info" title="Wie funktioniert die Simulation?">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <path d="M12 16v-4M12 8h.01"/>
      </svg>
      Wie funktioniert's?
    </button>
    <p class="tagline">Steuer-optimiert mit Depot-Trick, Sonderausgaben & dynamischen Sparraten.</p>
  </header>

  <!-- Info Modal -->
  <div class="modal-overlay" id="info-modal" aria-hidden="true">
    <div class="modal">
      <div class="modal-header">
        <h2>Wie funktioniert die Simulation?</h2>
        <button class="modal-close" id="modal-close" aria-label="Schlie√üen">&times;</button>
      </div>
      <div class="modal-body">
        <section class="info-section">
          <h3>üìä Standard-Simulation</h3>
          <p>Die Standard-Simulation berechnet den Verm√∂gensverlauf mit <strong>festen Renditen</strong>:</p>
          <ul>
            <li><strong>Ansparphase:</strong> Monatliche Einzahlungen auf Tagesgeld und ETF mit dynamischer Erh√∂hung (Gehaltserh√∂hung p.a.)</li>
            <li><strong>Tagesgeld-Ziel:</strong> √úbersch√ºsse werden automatisch in ETF umgeschichtet</li>
            <li><strong>Entnahmephase:</strong> Monatliche Entnahmen nach der 4%-Regel oder festem Betrag</li>
          </ul>
        </section>

        <section class="info-section">
          <h3>üé≤ Monte-Carlo-Simulation</h3>
          <p>Die Monte-Carlo-Simulation f√ºhrt <strong>hunderte/tausende Durchl√§ufe</strong> mit zuf√§lligen ETF-Renditen durch:</p>
          <ul>
            <li><strong>Renditemodell:</strong> Geometrische Brownsche Bewegung (GBM) mit Normalverteilung</li>
            <li><strong>Parameter:</strong> Erwartete Rendite (eingegebene ETF-Rendite) und Volatilit√§t (Standardabweichung)</li>
            <li><strong>Monatliche Rendite:</strong> <code>r = Œº/12 + œÉ/‚àö12 √ó Z</code> (Z = Zufallszahl aus Standardnormalverteilung)</li>
          </ul>
          <p>Die Ergebnisse zeigen die <strong>Verteilung m√∂glicher Ausg√§nge</strong> ‚Äì von Best Case bis Worst Case.</p>
        </section>

        <section class="info-section">
          <h3>üí∞ Steuerberechnung (Deutschland)</h3>
          <ul>
            <li><strong>Kapitalertragsteuer:</strong> 25% auf Gewinne</li>
            <li><strong>Solidarit√§tszuschlag:</strong> 5,5% auf KESt</li>
            <li><strong>Kirchensteuer:</strong> 8% oder 9% (optional, reduziert KESt leicht)</li>
            <li><strong>Teilfreistellung:</strong> 30% der ETF-Gewinne sind steuerfrei (Aktienfonds)</li>
            <li><strong>Sparerpauschbetrag:</strong> 1.000‚Ç¨ (Single) / 2.000‚Ç¨ (Verheiratet) steuerfrei pro Jahr</li>
          </ul>
        </section>

        <section class="info-section">
          <h3>üîÑ Depot-Trick (LIFO)</h3>
          <p>Beim Verkauf werden die <strong>zuletzt gekauften Anteile zuerst verkauft</strong> (Last-In-First-Out). 
          Diese haben meist geringere Gewinne ‚Üí weniger Steuern. Umsetzbar durch separate Depots oder Teil√ºbertrag.</p>
        </section>

        <section class="info-section">
          <h3>üìà Wichtige Kennzahlen</h3>
          <ul>
            <li><strong>Erfolgswahrscheinlichkeit:</strong> % der Simulationen, bei denen das Verm√∂gen nicht aufgebraucht wird</li>
            <li><strong>Kapitalerhalt:</strong> % der F√§lle, wo Endverm√∂gen ‚â• Verm√∂gen bei Rentenbeginn</li>
            <li><strong>Pleite-Risiko:</strong> % der F√§lle, wo Verm√∂gen unter 10.000‚Ç¨ f√§llt</li>
            <li><strong>Perzentile:</strong> 5%/25%/50%/75%/95% zeigen die Verteilung der Ergebnisse</li>
          </ul>
        </section>

        <section class="info-section">
          <h3>‚ö†Ô∏è Hinweise</h3>
          <ul>
            <li>Die Simulation ist eine <strong>Sch√§tzung</strong>, keine Garantie</li>
            <li>Historische Renditen sind keine Garantie f√ºr zuk√ºnftige Ergebnisse</li>
            <li>Volatilit√§t von 15-20% ist typisch f√ºr globale Aktien-ETFs</li>
            <li>Die 4%-Regel basiert auf historischen US-Daten (Trinity-Studie)</li>
          </ul>
        </section>
      </div>
    </div>
  </div>

  <main class="page">
    <section class="panel panel--inputs">
      <form id="sim-form" novalidate>
        <div class="group">
          <div class="group__header">
            <h2>Basisdaten & Zinsen</h2>
            <p>Startwerte, Zinsen und TG-Ziel.</p>
          </div>
          <div class="grid">
            <label class="field">
              <span class="field-label" data-tooltip="Aktueller Kontostand auf deinem Tagesgeldkonto zu Beginn der Simulation.">Start Tagesgeld (EUR)</span>
              <input type="number" step="100" id="start_savings" value="4000">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Aktueller Wert deines ETF-Depots zu Beginn der Simulation.">Start ETF (EUR)</span>
              <input type="number" step="100" id="start_etf" value="100">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="J√§hrlicher Zinssatz f√ºr dein Tagesgeldkonto. Aktuelle Zinsen liegen bei 2-4%.">Tagesgeld Zins p.a. (%)</span>
              <input type="number" step="0.1" id="savings_rate" value="3.0">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Erwartete j√§hrliche ETF-Rendite vor Kosten. Historisch ~7% f√ºr MSCI World (inflationsbereinigt ~5%).">ETF Rendite p.a. (%)</span>
              <input type="number" step="0.1" id="etf_rate" value="6.0">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Total Expense Ratio - j√§hrliche Fondskosten, die automatisch vom ETF-Wert abgezogen werden. Typisch 0.1-0.5% f√ºr ETFs.">ETF Kosten (TER) p.a. (%)</span>
              <input type="number" step="0.01" id="etf_ter" value="0.2">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Ziel-Saldo f√ºr Tagesgeld (Notgroschen). √úbersch√ºsse werden automatisch in ETF umgeschichtet.">Tagesgeld-Ziel (EUR)</span>
              <input type="number" step="100" id="savings_target" value="5000">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="J√§hrliche Inflationsrate f√ºr Kaufkraftberechnung. EZB-Ziel: 2%, historisch ~2-3%.">Inflation p.a. (%)</span>
              <input type="number" step="0.1" id="inflation_rate" value="2.0">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="J√§hrlicher steuerfreier Freibetrag f√ºr Kapitalertr√§ge. 1.000‚Ç¨ f√ºr Singles, 2.000‚Ç¨ f√ºr Verheiratete.">Sparerpauschbetrag (EUR)</span>
              <input type="number" step="100" id="sparerpauschbetrag" value="1000">
              <small class="field-hint">1000 EUR (Single) / 2000 EUR (Verheiratet)</small>
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Zus√§tzliche Steuer auf Kapitalertr√§ge f√ºr Kirchenmitglieder. Reduziert die Kapitalertragsteuer leicht (Sonderausgabenabzug).">Kirchensteuer</span>
              <select id="kirchensteuer">
                <option value="keine">Keine Kirchensteuer</option>
                <option value="8">8% (Bayern, Baden-W\u00fcrttemberg)</option>
                <option value="9">9% (andere Bundesl\u00e4nder)</option>
              </select>
            </label>
          </div>
        </div>

        <div class="group">
          <div class="group__header">
            <h2>Ansparphase</h2>
            <p>Monatliche Raten, Dynamik und Sonderausgaben.</p>
          </div>
          <div class="grid">
            <label class="field">
              <span class="field-label" data-tooltip="Wie lange du monatlich einzahlen m√∂chtest, bevor die Entnahmephase beginnt (z.B. bis zur Rente).">Dauer Ansparen (Jahre)</span>
              <input type="number" step="1" id="years_save" value="36">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Monatlicher Sparbetrag auf das Tagesgeldkonto. Wird j√§hrlich um die Gehaltserh√∂hung angepasst.">Monatlich Tagesgeld (EUR)</span>
              <input type="number" step="50" id="monthly_savings" value="100">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Monatlicher Sparplan-Betrag f√ºr den ETF. Wird j√§hrlich um die Gehaltserh√∂hung angepasst.">Monatlich ETF (EUR)</span>
              <input type="number" step="50" id="monthly_etf" value="150">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="J√§hrliche Erh√∂hung deiner Sparraten (TG + ETF). Typisch: 2-3% entsprechend der Inflation/Gehaltssteigerung.">Gehaltserh√∂hung p.a. (%)</span>
              <input type="number" step="0.1" id="annual_raise" value="3.0">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Gr√∂√üere Einmalausgaben in der Ansparphase (z.B. Auto, Urlaub, Renovierung). Werden vom Verm√∂gen abgezogen.">Sonderausgabe Anspar (EUR)</span>
              <input type="number" step="500" id="special_savings" value="15000">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Alle wie viele Jahre die Sonderausgabe in der Ansparphase f√§llig wird. 0 = keine Sonderausgaben.">Sonderausgabe Anspar alle X J.</span>
              <input type="number" step="1" id="special_savings_interval" value="10">
            </label>
            <label class="field field--checkbox">
              <input type="checkbox" id="inflation_adjust_special_savings" checked>
              <span class="field-label" data-tooltip="Wenn aktiviert, steigen die Sonderausgaben j√§hrlich mit der Inflation (z.B. Autos werden teurer).">Sonderausgaben Anspar inflationsanpassen</span>
            </label>
          </div>
        </div>

        <div class="group">
          <div class="group__header">
            <h2>Entnahmephase</h2>
            <p>Rentenmodus, Sonderausgaben und Dauer.</p>
          </div>
          <div class="grid grid--split">
            <label class="field">
              <span class="field-label" data-tooltip="Wie lange du monatlich Geld entnehmen m√∂chtest (z.B. erwartete Rentendauer). ">Dauer Entnahme (Jahre)</span>
              <input type="number" step="1" id="years_withdraw" value="30">
            </label>
            <div class="field">
              <span class="field-label" data-tooltip="W√§hle zwischen fester monatlicher Entnahme in Euro oder prozentualem Anteil vom Gesamtverm√∂gen (4%-Regel).">Wunschrente</span>
              <div class="mode-switch">
                <label><input type="radio" name="rent_mode" value="eur" checked> EUR / Monat</label>
                <label><input type="radio" name="rent_mode" value="percent"> % vom Verm√∂gen (p.a.)</label>
              </div>
            </div>
            <label class="field">
              <span class="field-label" data-tooltip="Fester monatlicher Entnahmebetrag nach Steuern. Wird bei aktivierter Inflation j√§hrlich angepasst.">Wunschrente Netto (EUR)</span>
              <input type="number" step="50" id="rent_eur" value="1000">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Entnahme als Prozent des Gesamtverm√∂gens pro Jahr (4%-Regel). 4% gilt als sichere Entnahmerate √ºber 30 Jahre.">Wunschrente % vom Verm√∂gen p.a.</span>
              <input type="number" step="0.1" id="rent_percent" value="4.0">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Mindestentnahme pro Monat (nur bei %-Modus). Verhindert zu niedrige Entnahmen in schlechten B√∂rsenphasen.">Entnahme-Untergrenze (EUR/Monat)</span>
              <input type="number" step="50" id="withdrawal_min" value="0">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Maximalentnahme pro Monat (nur bei %-Modus). Begrenzt Entnahmen in sehr guten B√∂rsenphasen. 0 = keine Grenze.">Entnahme-Obergrenze (EUR/Monat)</span>
              <input type="number" step="50" id="withdrawal_max" value="0">
            </label>
            <label class="field field--checkbox">
              <input type="checkbox" id="inflation_adjust_withdrawal" checked>
              <span class="field-label" data-tooltip="Erh√∂ht die Entnahme j√§hrlich um die Inflation, um die Kaufkraft zu erhalten. Klassische 4%-Regel nutzt dies.">Entnahme j√§hrlich inflationsanpassen (4%-Regel)</span>
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Gr√∂√üere Einmalausgaben in der Entnahmephase (z.B. Reisen, Pflege, Reparaturen). Werden zus√§tzlich zur Rente entnommen.">Sonderausgabe Entnahme (EUR)</span>
              <input type="number" step="500" id="special_withdraw" value="15000">
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Alle wie viele Jahre die Sonderausgabe in der Entnahmephase f√§llig wird. 0 = keine Sonderausgaben.">Sonderausgabe Entnahme alle X J.</span>
              <input type="number" step="1" id="special_withdraw_interval" value="10">
            </label>
            <label class="field field--checkbox">
              <input type="checkbox" id="inflation_adjust_special_withdrawal" checked>
              <span class="field-label" data-tooltip="Wenn aktiviert, steigen die Sonderausgaben in der Entnahmephase j√§hrlich mit der Inflation.">Sonderausgaben Entnahme inflationsanpassen</span>
            </label>
          </div>
        </div>

        <div class="group">
          <div class="group__header">
            <h2>Monte-Carlo-Simulation</h2>
            <p>Stochastische Analyse mit variabler ETF-Rendite.</p>
          </div>
          <div class="grid">
            <label class="field">
              <span class="field-label" data-tooltip="Wie oft die Simulation mit zuf√§lligen Renditen durchgef√ºhrt wird. Mehr = genauere Statistik, aber l√§nger.">Anzahl Simulationen</span>
              <input type="number" step="100" id="mc_iterations" value="1000" min="100" max="10000">
              <small class="field-hint">100-10.000 Durchl√§ufe</small>
            </label>
            <label class="field">
              <span class="field-label" data-tooltip="Standardabweichung der j√§hrlichen ETF-Rendite. H√∂here Werte = gr√∂√üere Schwankungen. MSCI World: ~15-17%.">ETF Volatilit√§t p.a. (%)</span>
              <input type="number" step="0.5" id="mc_volatility" value="15.0" min="1" max="50">
              <small class="field-hint">Historisch ~15-20% f√ºr Aktien-ETFs</small>
            </label>
            <label class="field field--checkbox">
              <input type="checkbox" id="mc_show_individual" unchecked>
              <span class="field-label" data-tooltip="Zeigt bis zu 50 einzelne Simulationspfade im Chart an, um die Streuung zu visualisieren.">Einzelne Pfade anzeigen (max. 50)</span>
            </label>
          </div>
        </div>

        <div class="actions">
          <button type="submit" class="btn btn--primary">Simulation starten</button>
          <button type="button" id="btn-monte-carlo" class="btn btn--accent">Monte-Carlo starten</button>
          <div class="btn-group">
            <button type="button" id="btn-reset" class="btn btn--secondary">Zur√ºcksetzen</button>
            <button type="button" id="btn-export" class="btn btn--secondary">CSV Export</button>
          </div>
          <p class="hint">Hinweis: Simulation nutzt automatisch den ‚ÄûDepot-Trick" (j√ºngste Anteile zuerst) f√ºr geringere Steuerlast. Tagesgeldzinsen werden ebenfalls besteuert.</p>
        </div>
        <div id="message" class="message" role="alert" aria-live="polite"></div>
      </form>
    </section>

    <section class="panel panel--results">
      <!-- Tab Navigation -->
      <div class="tabs">
        <button class="tab tab--active" data-tab="standard">
          <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 3v18h18"/><path d="M18 9l-5 5-4-4-3 3"/>
          </svg>
          Standard
        </button>
        <button class="tab" data-tab="tabelle">
          <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18M3 15h18M9 3v18"/>
          </svg>
          Jahres√ºbersicht
        </button>
        <button class="tab" data-tab="monte-carlo">
          <svg class="tab-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/>
          </svg>
          Monte-Carlo
          <span class="tab-badge" id="mc-badge" style="display: none;">‚úì</span>
        </button>
      </div>

      <!-- Tab: Standard-Simulation -->
      <div class="tab-content tab-content--active" id="tab-standard">
        <div class="result-header">
          <div>
            <p class="eyebrow">Visualisierung</p>
            <h2>Verm√∂gensverlauf</h2>
          </div>
          <div class="chart-controls">
            <button type="button" class="btn-scale" id="btn-std-log" title="Logarithmische Skala">
              Log
            </button>
            <button type="button" class="btn-scale btn-scale--active" id="btn-std-linear" title="Lineare Skala">
              Linear
            </button>
          </div>
        </div>
        <div class="mc-legend">
          <span class="legend__item"><span class="dot dot--total"></span>Gesamtverm√∂gen</span>
          <span class="legend__item"><span class="dot dot--real"></span>Gesamt (inflationsbereinigt)</span>
        </div>
        <div class="graph-wrapper">
          <canvas id="graph" aria-label="Verm√∂gensgraph"></canvas>
        </div>

        <div class="result-header result-header--stats">
          <div>
            <p class="eyebrow">Zusammenfassung</p>
            <h2>Simulationsergebnisse</h2>
          </div>
        </div>
        <div id="stats-panel" class="stats-panel">
          <div class="stats-grid">
            <div class="stat-card">
              <span class="stat-label">Endverm√∂gen (nominal)</span>
              <span class="stat-value" id="stat-end-nominal">-</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Endverm√∂gen (real)</span>
              <span class="stat-value" id="stat-end-real">-</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Eingezahlt gesamt</span>
              <span class="stat-value" id="stat-total-invested">-</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Rendite gesamt</span>
              <span class="stat-value" id="stat-total-return">-</span>
            </div>
            <div class="stat-card stat-card--clickable" id="stat-card-avg-nominal" title="Klicken zum Umschalten: mit/ohne Sonderausgaben">
              <span class="stat-label">√ò Entnahme/Monat (nominal) <span class="stat-toggle-hint" id="stat-toggle-hint-1">ohne Sonder</span></span>
              <span class="stat-value" id="stat-avg-withdrawal">-</span>
            </div>
            <div class="stat-card stat-card--clickable" id="stat-card-avg-real" title="Klicken zum Umschalten: mit/ohne Sonderausgaben">
              <span class="stat-label">√ò Entnahme/Monat (real) <span class="stat-toggle-hint" id="stat-toggle-hint-2">ohne Sonder</span></span>
              <span class="stat-value stat-value--highlight" id="stat-avg-withdrawal-real">-</span>
            </div>
            <div class="stat-card stat-card--clickable" id="stat-card-minmax-nominal" title="Klicken zum Umschalten: mit/ohne Sonderausgaben">
              <span class="stat-label">Min/Max Entnahme (nominal) <span class="stat-toggle-hint" id="stat-toggle-hint-3">ohne Sonder</span></span>
              <span class="stat-value" id="stat-minmax-withdrawal">-</span>
            </div>
            <div class="stat-card stat-card--clickable" id="stat-card-minmax-real" title="Klicken zum Umschalten: mit/ohne Sonderausgaben">
              <span class="stat-label">Min/Max Entnahme (real) <span class="stat-toggle-hint" id="stat-toggle-hint-4">ohne Sonder</span></span>
              <span class="stat-value stat-value--highlight" id="stat-minmax-withdrawal-real">-</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Steuern gesamt</span>
              <span class="stat-value" id="stat-total-tax">-</span>
            </div>
            <div class="stat-card">
              <span class="stat-label">Effektive Entnahmerate</span>
              <span class="stat-value" id="stat-effective-rate">-</span>
            </div>
          </div>
          <div id="stat-warning" class="stat-warning"></div>
        </div>
      </div>

      <!-- Tab: Monte-Carlo -->
      <div class="tab-content" id="tab-monte-carlo">
        <div class="mc-empty-state" id="mc-empty-state">
          <div class="mc-empty-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
              <path d="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/>
              <circle cx="12" cy="12" r="3"/>
            </svg>
          </div>
          <h3>Monte-Carlo-Simulation starten</h3>
          <p>Klicke auf "Monte-Carlo starten" um eine stochastische Analyse mit variabler ETF-Rendite durchzuf√ºhren.</p>
          <p class="mc-empty-hint">Die Simulation f√ºhrt hunderte Durchl√§ufe mit zuf√§lligen Renditen durch und zeigt die Erfolgswahrscheinlichkeit deiner Entnahme-Strategie.</p>
        </div>

        <div id="mc-results" class="mc-results" style="display: none;">
          <div class="mc-progress-bar" id="mc-progress-bar">
            <progress id="mc-progress" value="0" max="100"></progress>
            <span id="mc-progress-text"></span>
          </div>

          <!-- Highlight: Erfolgswahrscheinlichkeit -->
          <div class="mc-highlight">
            <div class="mc-highlight-main">
              <span class="mc-highlight-label">Erfolgswahrscheinlichkeit</span>
              <span class="mc-highlight-value" id="mc-success-rate">-</span>
              <span class="mc-highlight-hint">Verm√∂gen reicht f√ºr den gesamten Entnahmezeitraum</span>
            </div>
            <div class="mc-highlight-meta">
              <span id="mc-iterations-done">-</span> Simulationen durchgef√ºhrt
            </div>
          </div>

          <!-- Chart direkt nach Erfolgswahrscheinlichkeit (wie bei Standard) -->
          <div class="result-header">
            <div>
              <p class="eyebrow">Visualisierung</p>
              <h2>Verm√∂gensverteilung √ºber Zeit</h2>
            </div>
            <div class="chart-controls">
              <button type="button" class="btn-scale btn-scale--active" id="btn-mc-log" title="Logarithmische Skala">
                Log
              </button>
              <button type="button" class="btn-scale" id="btn-mc-linear" title="Lineare Skala">
                Linear
              </button>
            </div>
          </div>
          <div class="mc-legend">
            <span class="legend__item"><span class="dot dot--mc-median"></span>Median (50%)</span>
            <span class="legend__item"><span class="dot dot--mc-50"></span>25%-75%</span>
            <span class="legend__item"><span class="dot dot--mc-80"></span>10%-90%</span>
            <span class="legend__item"><span class="dot dot--mc-p5"></span>5% (Worst)</span>
            <span class="legend__item"><span class="dot dot--mc-p95"></span>95% (Best)</span>
          </div>
          <div class="graph-wrapper">
            <canvas id="mc-graph" aria-label="Monte-Carlo Verm√∂gensgraph"></canvas>
          </div>

          <!-- Statistiken (wie bei Standard: nach dem Chart) -->
          <div class="result-header result-header--stats">
            <div>
              <p class="eyebrow">Zusammenfassung</p>
              <h2>Simulationsergebnisse</h2>
            </div>
          </div>
          
          <!-- Nominale Werte -->
          <div class="mc-stats-section">
            <h4 class="mc-stats-title">Nominale Werte</h4>
            <div class="stats-grid stats-grid--mc">
              <div class="stat-card stat-card--mc">
                <span class="stat-label">Endverm√∂gen (Median)</span>
                <span class="stat-value" id="mc-median-end">-</span>
                <small class="stat-hint">50% Perzentil</small>
              </div>
              <div class="stat-card stat-card--mc">
                <span class="stat-label">Endverm√∂gen (10%-90%)</span>
                <span class="stat-value" id="mc-range-end">-</span>
                <small class="stat-hint">80% Konfidenzintervall</small>
              </div>
              <div class="stat-card stat-card--mc stat-card--worst">
                <span class="stat-label">Worst Case (5%)</span>
                <span class="stat-value" id="mc-worst-case">-</span>
                <small class="stat-hint">Nur 5% sind schlechter</small>
              </div>
              <div class="stat-card stat-card--mc stat-card--best">
                <span class="stat-label">Best Case (95%)</span>
                <span class="stat-value" id="mc-best-case">-</span>
                <small class="stat-hint">Nur 5% sind besser</small>
              </div>
            </div>
          </div>

          <!-- Inflationsbereinigte Werte -->
          <div class="mc-stats-section">
            <h4 class="mc-stats-title">Inflationsbereinigt (real)</h4>
            <div class="stats-grid stats-grid--mc">
              <div class="stat-card stat-card--mc">
                <span class="stat-label">Endverm√∂gen (Median)</span>
                <span class="stat-value stat-value--highlight" id="mc-median-end-real">-</span>
                <small class="stat-hint">50% Perzentil in heutiger Kaufkraft</small>
              </div>
              <div class="stat-card stat-card--mc">
                <span class="stat-label">Endverm√∂gen (10%-90%)</span>
                <span class="stat-value stat-value--highlight" id="mc-range-end-real">-</span>
                <small class="stat-hint">80% Konfidenzintervall</small>
              </div>
              <div class="stat-card stat-card--mc stat-card--worst">
                <span class="stat-label">Worst Case (5%)</span>
                <span class="stat-value" id="mc-worst-case-real">-</span>
                <small class="stat-hint">In heutiger Kaufkraft</small>
              </div>
              <div class="stat-card stat-card--mc stat-card--best">
                <span class="stat-label">Best Case (95%)</span>
                <span class="stat-value" id="mc-best-case-real">-</span>
                <small class="stat-hint">In heutiger Kaufkraft</small>
              </div>
            </div>
          </div>

          <!-- Weitere Kennzahlen -->
          <div class="mc-stats-section">
            <h4 class="mc-stats-title">Weitere Kennzahlen</h4>
            <div class="stats-grid stats-grid--mc">
              <div class="stat-card stat-card--mc">
                <span class="stat-label">Verm√∂gen bei Rentenbeginn</span>
                <span class="stat-value" id="mc-retirement-wealth">-</span>
                <small class="stat-hint">Median am Start der Entnahme</small>
              </div>
              <div class="stat-card stat-card--mc">
                <span class="stat-label">Kapitalerhalt-Wahrscheinlichkeit</span>
                <span class="stat-value" id="mc-capital-preservation">-</span>
                <small class="stat-hint">Endverm√∂gen ‚â• Startverm√∂gen Entnahme</small>
              </div>
              <div class="stat-card stat-card--mc">
                <span class="stat-label">Pleite-Risiko</span>
                <span class="stat-value" id="mc-ruin-probability">-</span>
                <small class="stat-hint">Verm√∂gen f√§llt unter 10.000 ‚Ç¨</small>
              </div>
              <div class="stat-card stat-card--mc">
                <span class="stat-label">Durchschnittl. Endverm√∂gen</span>
                <span class="stat-value" id="mc-mean-end">-</span>
                <small class="stat-hint">Arithmetisches Mittel</small>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab: Jahres√ºbersicht -->
      <div class="tab-content" id="tab-tabelle">
        <div class="result-header">
          <div>
            <p class="eyebrow">Jahres√ºbersicht</p>
            <h2>Aggregierte Werte pro Jahr</h2>
          </div>
        </div>
        <div class="table-wrapper">
          <table id="year-table">
            <thead>
              <tr>
                <th>Jahr</th>
                <th>Phase</th>
                <th>TG-Saldo</th>
                <th>ETF-Saldo</th>
                <th>Gesamt</th>
                <th>Gesamt (real)</th>
                <th>Rendite</th>
                <th>Entnahme</th>
                <th>Steuern</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <p>Statische Web-App ‚Äì bereit f√ºr GitHub Pages. Keine Serverabh√§ngigkeiten.</p>
  </footer>

  <div id="tooltip" class="tooltip" aria-hidden="true"></div>

  <script src="app.js"></script>
</body>
</html>
