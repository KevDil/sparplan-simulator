<!doctype html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sparplan & Entnahme Simulator (Web)</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <div class="brand__dot"></div>
      <div>
        <p class="eyebrow">ETF & Tagesgeld</p>
        <h1>Sparplan- & Entnahme-Simulator</h1>
      </div>
    </div>
    <p class="tagline">Steuer-optimiert mit Depot-Trick, Sonderausgaben & dynamischen Sparraten.</p>
  </header>

  <main class="page">
    <section class="panel panel--inputs">
      <form id="sim-form" novalidate>
        <div class="group">
          <div class="group__header">
            <h2>Basisdaten & Zinsen</h2>
            <p>Startwerte, Zinsen und TG-Ziel.</p>
          </div>
          <div class="grid">
            <label class="field">
              <span>Start Tagesgeld (EUR)</span>
              <input type="number" step="100" id="start_savings" value="4000">
            </label>
            <label class="field">
              <span>Start ETF (EUR)</span>
              <input type="number" step="100" id="start_etf" value="100">
            </label>
            <label class="field">
              <span>Tagesgeld Zins p.a. (%)</span>
              <input type="number" step="0.1" id="savings_rate" value="3.0">
            </label>
            <label class="field">
              <span>ETF Rendite p.a. (%)</span>
              <input type="number" step="0.1" id="etf_rate" value="6.0">
            </label>
            <label class="field">
              <span>ETF Kosten (TER) p.a. (%)</span>
              <input type="number" step="0.01" id="etf_ter" value="0.2">
            </label>
            <label class="field">
              <span>Tagesgeld-Ziel (EUR)</span>
              <input type="number" step="100" id="savings_target" value="5000">
            </label>
            <label class="field">
              <span>Inflation p.a. (%)</span>
              <input type="number" step="0.1" id="inflation_rate" value="2.0">
            </label>
            <label class="field">
              <span>Sparerpauschbetrag (EUR)</span>
              <input type="number" step="100" id="sparerpauschbetrag" value="1000">
              <small class="field-hint">1000 EUR (Single) / 2000 EUR (Verheiratet)</small>
            </label>
            <label class="field">
              <span>Kirchensteuer</span>
              <select id="kirchensteuer">
                <option value="keine">Keine Kirchensteuer</option>
                <option value="8">8% (Bayern, Baden-W\u00fcrttemberg)</option>
                <option value="9">9% (andere Bundesl\u00e4nder)</option>
              </select>
            </label>
          </div>
        </div>

        <div class="group">
          <div class="group__header">
            <h2>Ansparphase</h2>
            <p>Monatliche Raten, Dynamik und Sonderausgaben.</p>
          </div>
          <div class="grid">
            <label class="field">
              <span>Dauer Ansparen (Jahre)</span>
              <input type="number" step="1" id="years_save" value="36">
            </label>
            <label class="field">
              <span>Monatlich Tagesgeld (EUR)</span>
              <input type="number" step="50" id="monthly_savings" value="100">
            </label>
            <label class="field">
              <span>Monatlich ETF (EUR)</span>
              <input type="number" step="50" id="monthly_etf" value="150">
            </label>
            <label class="field">
              <span>Gehaltserhöhung p.a. (%)</span>
              <input type="number" step="0.1" id="annual_raise" value="3.0">
            </label>
            <label class="field">
              <span>Sonderausgabe Anspar (EUR)</span>
              <input type="number" step="500" id="special_savings" value="15000">
            </label>
            <label class="field">
              <span>Sonderausgabe Anspar alle X J.</span>
              <input type="number" step="1" id="special_savings_interval" value="10">
            </label>
            <label class="field field--checkbox">
              <input type="checkbox" id="inflation_adjust_special_savings" checked>
              <span>Sonderausgaben Anspar inflationsanpassen</span>
            </label>
          </div>
        </div>

        <div class="group">
          <div class="group__header">
            <h2>Entnahmephase</h2>
            <p>Rentenmodus, Sonderausgaben und Dauer.</p>
          </div>
          <div class="grid grid--split">
            <label class="field">
              <span>Dauer Entnahme (Jahre)</span>
              <input type="number" step="1" id="years_withdraw" value="30">
            </label>
            <div class="field">
              <span>Wunschrente</span>
              <div class="mode-switch">
                <label><input type="radio" name="rent_mode" value="eur" checked> EUR / Monat</label>
                <label><input type="radio" name="rent_mode" value="percent"> % vom Vermögen (p.a.)</label>
              </div>
            </div>
            <label class="field">
              <span>Wunschrente Netto (EUR)</span>
              <input type="number" step="50" id="rent_eur" value="1000">
            </label>
            <label class="field">
              <span>Wunschrente % vom Vermögen p.a.</span>
              <input type="number" step="0.1" id="rent_percent" value="4.0">
            </label>
            <label class="field">
              <span>Entnahme-Untergrenze (EUR/Monat)</span>
              <input type="number" step="50" id="withdrawal_min" value="0">
            </label>
            <label class="field">
              <span>Entnahme-Obergrenze (EUR/Monat)</span>
              <input type="number" step="50" id="withdrawal_max" value="0">
            </label>
            <label class="field field--checkbox">
              <input type="checkbox" id="inflation_adjust_withdrawal" checked>
              <span>Entnahme jährlich inflationsanpassen (4%-Regel)</span>
            </label>
            <label class="field">
              <span>Sonderausgabe Entnahme (EUR)</span>
              <input type="number" step="500" id="special_withdraw" value="15000">
            </label>
            <label class="field">
              <span>Sonderausgabe Entnahme alle X J.</span>
              <input type="number" step="1" id="special_withdraw_interval" value="10">
            </label>
            <label class="field field--checkbox">
              <input type="checkbox" id="inflation_adjust_special_withdrawal" checked>
              <span>Sonderausgaben Entnahme inflationsanpassen</span>
            </label>
          </div>
        </div>

        <div class="actions">
          <button type="submit" class="btn btn--primary">Simulation starten</button>
          <div class="btn-group">
            <button type="button" id="btn-reset" class="btn btn--secondary">Zurücksetzen</button>
            <button type="button" id="btn-export" class="btn btn--secondary">CSV Export</button>
          </div>
          <p class="hint">Hinweis: Simulation nutzt automatisch den \u201eDepot-Trick\u201c (j\u00fcngste Anteile zuerst) f\u00fcr geringere Steuerlast. Tagesgeldzinsen werden ebenfalls besteuert.</p>
        </div>
        <div id="message" class="message" role="alert" aria-live="polite"></div>
      </form>
    </section>

    <section class="panel panel--results">
      <div class="result-header">
        <div>
          <p class="eyebrow">Visualisierung</p>
          <h2>Vermögensverlauf</h2>
        </div>
        <div class="legend">
          <span class="legend__item"><span class="dot dot--total"></span>Gesamtvermögen</span>
          <span class="legend__item"><span class="dot dot--real"></span>Gesamt (inflationsbereinigt)</span>
        </div>
      </div>
      <div class="graph-wrapper">
        <canvas id="graph" aria-label="Vermögensgraph"></canvas>
      </div>

      <div class="result-header">
        <div>
          <p class="eyebrow">Jahresübersicht</p>
          <h2>Aggregierte Werte</h2>
        </div>
      </div>
      <div class="table-wrapper">
        <table id="year-table">
          <thead>
            <tr>
              <th>Jahr</th>
              <th>Phase</th>
              <th>TG-Saldo</th>
              <th>ETF-Saldo</th>
              <th>Gesamt</th>
              <th>Gesamt (real)</th>
              <th>Rendite</th>
              <th>Entnahme</th>
              <th>Steuern</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="result-header">
        <div>
          <p class="eyebrow">Zusammenfassung</p>
          <h2>Simulationsergebnisse</h2>
        </div>
      </div>
      <div id="stats-panel" class="stats-panel">
        <div class="stats-grid">
          <div class="stat-card">
            <span class="stat-label">Endvermögen (nominal)</span>
            <span class="stat-value" id="stat-end-nominal">-</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Endvermögen (real)</span>
            <span class="stat-value" id="stat-end-real">-</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Eingezahlt gesamt</span>
            <span class="stat-value" id="stat-total-invested">-</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Rendite gesamt</span>
            <span class="stat-value" id="stat-total-return">-</span>
          </div>
          <div class="stat-card stat-card--clickable" id="stat-card-avg-nominal" title="Klicken zum Umschalten: mit/ohne Sonderausgaben">
            <span class="stat-label">Ø Entnahme/Monat (nominal) <span class="stat-toggle-hint" id="stat-toggle-hint-1">ohne Sonder</span></span>
            <span class="stat-value" id="stat-avg-withdrawal">-</span>
          </div>
          <div class="stat-card stat-card--clickable" id="stat-card-avg-real" title="Klicken zum Umschalten: mit/ohne Sonderausgaben">
            <span class="stat-label">Ø Entnahme/Monat (real) <span class="stat-toggle-hint" id="stat-toggle-hint-2">ohne Sonder</span></span>
            <span class="stat-value stat-value--highlight" id="stat-avg-withdrawal-real">-</span>
          </div>
          <div class="stat-card stat-card--clickable" id="stat-card-minmax-nominal" title="Klicken zum Umschalten: mit/ohne Sonderausgaben">
            <span class="stat-label">Min/Max Entnahme (nominal) <span class="stat-toggle-hint" id="stat-toggle-hint-3">ohne Sonder</span></span>
            <span class="stat-value" id="stat-minmax-withdrawal">-</span>
          </div>
          <div class="stat-card stat-card--clickable" id="stat-card-minmax-real" title="Klicken zum Umschalten: mit/ohne Sonderausgaben">
            <span class="stat-label">Min/Max Entnahme (real) <span class="stat-toggle-hint" id="stat-toggle-hint-4">ohne Sonder</span></span>
            <span class="stat-value stat-value--highlight" id="stat-minmax-withdrawal-real">-</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Steuern gesamt</span>
            <span class="stat-value" id="stat-total-tax">-</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Effektive Entnahmerate</span>
            <span class="stat-value" id="stat-effective-rate">-</span>
          </div>
        </div>
        <div id="stat-warning" class="stat-warning"></div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <p>Statische Web-App – bereit für GitHub Pages. Keine Serverabhängigkeiten.</p>
  </footer>

  <div id="tooltip" class="tooltip" aria-hidden="true"></div>

  <script src="app.js"></script>
</body>
</html>
